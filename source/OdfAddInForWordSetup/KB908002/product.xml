<?xml version="1.0" encoding="utf-8" ?>
<Product
  xmlns="http://schemas.microsoft.com/developer/2004/01/bootstrapper"
  ProductCode="Microsoft.OtkLoader.2.0">

  <RelatedProducts>
    <DependsOnProduct Code="Microsoft.Net.Framework.2.0" />
  </RelatedProducts>

  <PackageFiles CopyAllPackageFiles="false">
    <PackageFile Name="lockbackRegKey.msi"/>
    <PackageFile Name="extensibilityMSM.msi"/>
    <PackageFile Name="office2003-kb907417sfxcab-ENU.exe"/>
	  <PackageFile Name="VerifPrequisites.exe"/>
  </PackageFiles>

	<InstallChecks>
  		<RegistryCheck Property="WordVersion" Key="HKCR\Word.Application\Curver" />
		<MsiProductCheck Property="lockbackRegKeyInstalled" Product="{64F3B15C-24C7-4B2B-9B72-65CCBBD7F06B}"/>
		<MsiProductCheck Property="extensibilityMSMInstalled" Product="{09959E11-AD5D-408E-96AF-E3346954D6B8}"/>
		<ExternalCheck Property="officePatchInstalled" PackageFile="VerifPrequisites.exe"/>
	</InstallChecks>
    
  <Commands Reboot="Defer">
    <Command PackageFile="lockbackRegKey.msi" Arguments=' /quiet'>
		<InstallConditions>
			<BypassIf Property="WordVersion" Compare="ValueEqualTo" Value="Word.Application.12"/>
			<BypassIf Property="lockbackRegKeyInstalled" Compare="ValueGreaterThanOrEqualTo" Value="1"/>
		</InstallConditions>
		<ExitCodes>
        <DefaultExitCode Result="Success"/>
      </ExitCodes>
    </Command>

    <Command PackageFile="extensibilityMSM.msi" Arguments=' /quiet'>
		<InstallConditions>
			<BypassIf Property="WordVersion" Compare="ValueEqualTo" Value="Word.Application.12"/>
			<BypassIf Property="extensibilityMSMInstalled" Compare="ValueGreaterThanOrEqualTo" Value="1"/>
		</InstallConditions>
		<ExitCodes>
        <DefaultExitCode Result="Success"/>
      </ExitCodes>
    </Command>

	  
    <Command PackageFile="office2003-kb907417sfxcab-ENU.exe" Arguments=' /quiet'>
		<InstallConditions>
			<BypassIf Property="WordVersion" Compare="ValueEqualTo" Value="Word.Application.12"/>		
			<BypassIf Property="officePatchInstalled" Compare="ValueGreaterThanOrEqualTo" Value="1"/>
		</InstallConditions>
		<ExitCodes>
        <DefaultExitCode Result="Success"/>
      </ExitCodes>
    </Command>
  </Commands>
</Product>